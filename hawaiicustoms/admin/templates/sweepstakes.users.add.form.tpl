<form action="index.php?ToDo=%%GLOBAL_FormAction%%" onSubmit="return ValidateForm(CheckForm)" name="frmAddSweepstakes" method="post" enctype="multipart/form-data">
<div class="BodyContainer">
	<table class="OuterPanel">
		<tr>
			<td class="Heading1">%%GLOBAL_SweepstakesUsersTitle%%</td>
		</tr>
		<tr>
		<td class="Intro">
			<p>%%GLOBAL_SweepstakesUsersIntro%%</p>
			%%GLOBAL_Message%%

		</td>
	</tr>

	<tr>
		<td>
			<div>
				<input type="submit" name="SubmitButton1" value="%%LNG_Save%%" class="FormButton">
				<input type="button" name="CancelButton1" value="%%LNG_Cancel%%" class="FormButton" onclick="ConfirmCancel()"><br /><img src="images/blank.gif" width="1" height="10" />
			</div>
		</td>
	</tr>
	<tr>
		<td>
			<table class="Panel">
				<tr>
					<td class="Heading2" colspan=2>%%LNG_SweepstakesUsersDetails%%</td>
				</tr>
                <tr>
                        <td class="FieldLabel">
                            <span class="Required">*</span>&nbsp;%%LNG_Email%%:
                        </td>
                        <td>
                            <input type="text" name="email" id="email" class="Field200" value="">
                            <span><img onmouseout="HideHelp('d1');" onmouseover="ShowHelp('d1', '%%LNG_Email%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0"></span>
                            <div style="display:none" id="d1"></div>
                        </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        <span class="Required">*</span>&nbsp;%%LNG_FirstName%%:
                    </td>
                    <td>
                        <input type="text" name="firstname" id="firstname" class="Field200" value="">
                            <img onmouseout="HideHelp('d2');" onmouseover="ShowHelp('d2', '%%LNG_FirstName%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d2"></div>
                    </td>
                </tr>
				<tr>
					<td class="FieldLabel">
						<span class="Required">*</span>&nbsp;%%LNG_LastName%%:
					</td>
					<td>
						<input type="text" name="lastname" id="lastname" class="Field200" value="">
                            <img onmouseout="HideHelp('d3');" onmouseover="ShowHelp('d3', '%%LNG_LastName%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d3"></div>
					</td>
				</tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_ReceivingMail%%:
                    </td>
                    <td>
                        <input type="checkbox" name="receivingmail" id="receivingmail" value="1">
                            <img onmouseout="HideHelp('d12');" onmouseover="ShowHelp('d12', '%%LNG_ReceivingMail%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d12"></div>
                    </td>
                </tr>                
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_PhoneNumber%%:
                    </td>
                    <td>
                        <input type="text" name="phonenumber" id="phonenumber" class="Field200" value="">
                            <img onmouseout="HideHelp('d4');" onmouseover="ShowHelp('d4', '%%LNG_PhoneNumber%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d4"></div>
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_AddressLine1%%:
                    </td>
                    <td>
                        <input type="text" name="addressline1" id="addressline1" class="Field200" value="">
                            <img onmouseout="HideHelp('d5');" onmouseover="ShowHelp('d5', '%%LNG_AddressLine1%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d5"></div>
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_AddressLine2%%:
                    </td>
                    <td>
                        <input type="text" name="addressline2" id="addressline2" class="Field200" value="">
                            <img onmouseout="HideHelp('d6');" onmouseover="ShowHelp('d6', '%%LNG_AddressLine2%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d6"></div>
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_City%%:
                    </td>
                    <td>
                        <input type="text" name="city" id="city" class="Field200" value="">
                            <img onmouseout="HideHelp('d7');" onmouseover="ShowHelp('d7', '%%LNG_City%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d7"></div>
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_State%%:
                    </td>
                    <td>
                        <select name="states">
                        <option>%%LNG_ChooseaState%%</option> 
                        <option value="Alabama">Alabama</option> 
                        <option value="Alaska">Alaska</option> 
                        <option value="Arizona">Arizona</option> 
                        <option value="Arkansas">Arkansas</option> 
                        <option value="California">California</option> 
                        <option value="Colorado">Colorado</option> 
                        <option value="Connecticut">Connecticut</option> 
                        <option value="Delaware">Delaware</option> 
                        <option value="District of Columbia">District of Columbia</option> 
                        <option value="Florida">Florida</option> 
                        <option value="Georgia">Georgia</option> 
                        <option value="Hawaii">Hawaii</option> 
                        <option value="Idaho">Idaho</option> 
                        <option value="Illinois">Illinois</option> 
                        <option value="Indiana">Indiana</option> 
                        <option value="Iowa">Iowa</option> 
                        <option value="Kansas">Kansas</option> 
                        <option value="Kentucky">Kentucky</option> 
                        <option value="Louisiana">Louisiana</option> 
                        <option value="Maine">Maine</option> 
                        <option value="Maryland">Maryland</option> 
                        <option value="Massachusetts">Massachusetts</option> 
                        <option value="Michigan">Michigan</option> 
                        <option value="Minnesota">Minnesota</option> 
                        <option value="Mississippi">Mississippi</option> 
                        <option value="Missouri">Missouri</option> 
                        <option value="Montana">Montana</option> 
                        <option value="Nebraska">Nebraska</option> 
                        <option value="Nevada">Nevada</option> 
                        <option value="New Hampshire">New Hampshire</option> 
                        <option value="New Jersey">New Jersey</option> 
                        <option value="New Mexico">New Mexico</option> 
                        <option value="New York">New York</option> 
                        <option value="North Carolina">North Carolina</option> 
                        <option value="North Dakota">North Dakota</option> 
                        <option value="Ohio">Ohio</option> 
                        <option value="Oklahoma">Oklahoma</option> 
                        <option value="Oregon">Oregon</option> 
                        <option value="Other, Call for quote">Other, Call for quote</option> 
                        <option value="Pennsylvania">Pennsylvania</option> 
                        <option value="Rhode Island">Rhode Island</option> 
                        <option value="South Carolina">South Carolina</option> 
                        <option value="South Dakota">South Dakota</option> 
                        <option value="Tennessee">Tennessee</option> 
                        <option value="Texas">Texas</option> 
                        <option value="Utah">Utah</option> 
                        <option value="Vermont">Vermont</option> 
                        <option value="Virginia">Virginia</option> 
                        <option value="Washington">Washington</option> 
                        <option value="West Virginia">West Virginia</option> 
                        <option value="Wisconsin">Wisconsin</option> 
                        <option value="Wyoming">Wyoming</option> 
                    </select>
                            <img onmouseout="HideHelp('d8');" onmouseover="ShowHelp('d8', '%%LNG_State%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d8"></div>
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_Country%%:
                    </td>
                    <td>
                        United States
                    </td>
                </tr>
                <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_ZipCode%%:
                    </td>
                    <td>
                        <input type="text" name="zipcode" id="zipcode" class="Field100" value="">
                            <img onmouseout="HideHelp('d10');" onmouseover="ShowHelp('d10', '%%LNG_ZipCode%%', '%%GLOBAL_1%%')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d10"></div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align="left">
                         <ul style="list-style:none;">
                            <li style="display:inline; margin-right: 30px;"> <label id="yearlabel">Year:</label> <select id="searchyear" style="padding: 3px;" name="searchyear" onchange="getSearchOptions('year',0)">
                            %%GLOBAL_YearList%%
                             </select></li>

                            <li style="display:inline; margin-right: 30px;"><label>Make:</label><select id="searchmake" style="padding: 3px;" name="searchmake" onchange="getSearchOptions('make',0)">
                            %%GLOBAL_MakeList%%
                            </select>
                            </li>
                            <li style="display:inline; margin-right: 30px;"><label>Model:</label><select id="searchmodel" style="padding: 3px;" name="searchmodel" onchange="getSearchOptions('model',0)">
                            %%GLOBAL_ModelList%%
                            </select>
                            </li>
                         </ul>
                    </td>
                </tr>
                 <tr>
                    <td class="FieldLabel">
                        &nbsp;&nbsp;&nbsp;%%LNG_UrlReferrer%%:
                    </td>
                    <td>
                        <input type="text" name="urlreferrer" id="urlreferrer" class="Field200" value="">
                            <img onmouseout="HideHelp('d11');" onmouseover="ShowHelp('d11', '%%LNG_UrlReferrer%% eg: http://www.truckchamp.com/?harley', '')" src="images/help.gif" width="24" height="16" border="0">
                            <div style="display:none" id="d11"></div>
                    </td>
                </tr>
			</table>
		</td>
	</tr>
    <tr><td class="Gap" colspan="2"></td></tr> 
    <tr>
        <td>
            <input type="submit" name="SubmitButton2" value="%%LNG_Save%%" class="FormButton">
            <input type="button" name="CancelButton2" value="%%LNG_Cancel%%" class="FormButton" onclick="ConfirmCancel()">
        </td>
    </tr>   
</table>
</div>
</form>

<script type="text/javascript">

    function CheckForm() {

        var firstname = document.getElementById("firstname");
        var lastname = document.getElementById("lastname");
        
         var inputString = document.getElementById('email').value;
         if($('#email').val()) {
             var expression = /^([a-z]{1}[-a-zA-Z0-9_\.]*)@([-a-zA-Z0-9]+)([\.][a-zA-Z]+)+$/;
             if(matchExpression(expression,inputString) == false) {
                alert('%%LNG_EmailValid%%');
                $('#email').focus();
                return false;
             }
         }
         else {
            alert('%%LNG_Enteremail%%');
            $('#email').focus();
            return false;
         }
        if(firstname.value == "") {
            alert("%%LNG_Enterfirstname%%");
            firstname.focus();
            return false;
        }
        if(lastname.value == "") {
            alert("%%LNG_Enterlastname%%");
            lastname.focus();
            return false;
        }

        if($.trim($('#urlreferrer').val()) != "")
        {
			if(!IsURL($.trim($('#urlreferrer').val())))
			{
				 alert("%%LNG_EnterCorrectUrlReferrer%%");
				 document.getElementById("urlreferrer").focus();
		         return false;
			}
        }
        return true;
    }
    
    function matchExpression(expression,inputString)
    {
        if(inputString.search(expression)==-1)
        {
            return false;
        }
        else
        {
            return true;
        }
    }

    function ConfirmCancel()
    {
        if(confirm('%%GLOBAL_CancelMessageUsers%%'))
            document.location.href='index.php?ToDo=viewerSweepstakes';
        else
            return false;
    }
    function IsURL(str_url)
    {
      var strRegex = "^((https|http|ftp)?://).*";
      
      var re=new RegExp(strRegex); 
            
      //re.test()
            if (re.test(str_url)){
                return (true); 
            }else{ 
                return (false); 
            }
    }
    	    

    function getSearchOptions(searchtype,catuniversal) 
    {
        var make = $('#searchmake').val();

        if(searchtype == 'make' && make == '')
        {
            $('#searchmodel').find('option').remove().end();
            $('#searchmodel').append('<option value=\'\'>--select model--</option>');
            //return false;
        }

        var model = $('#searchmodel').val();
        var year = $('#searchyear').val();
        var universal = catuniversal;

        var params = 'autopopulate=true&make='+make+'&model='+model+'&year='+year+'&universal='+universal+'&ymmtype='+searchtype;

        $.ajax({
        type: "GET",
        url: "%%GLOBAL_ShopPath%%/redefine_filters.php",
        data: params,
        success: function(msg){
            var ymm_array=msg.split("~");
            if(searchtype == 'make')
            {
                $('#searchmodel').find('option').remove().end();
                $('#searchmodel').append(ymm_array[0]);
                /*if(year == '')
                {*/
                    $('#searchyear').find('option').remove().end();
                    $('#searchyear').append(ymm_array[1]);
                /*}*/
            }
            else if(searchtype == 'model')
            {
                if(year == '')
                {
                    $('#searchyear').find('option').remove().end();
                    $('#searchyear').append(ymm_array[0]);
                }
            }
            else if(searchtype == 'year')
            {
                if(make != '')
                {
                    $('#searchmodel').find('option').remove().end();
                    $('#searchmodel').append(ymm_array[0]);
                }                    
            }               
        }
        });

    }

</script>